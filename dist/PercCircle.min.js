!function(){function t(t,i){for(var a in i)t.hasOwnProperty(a)&&(t[a]=i[a])}function i(){var t=this.el.clientHeight,i=this.el.clientWidth;this.canvas=document.createElement("canvas"),this.canvas.style.height=t+"px",this.canvas.style.width=i+"px",this.canvas.height=this.canvasHeight,this.canvas.width=this.canvasWidth,this.el.appendChild(this.canvas),this.context=this.canvas.getContext("2d")}function a(){var t,i,a=this.options.data,n=0,s=0,o=0;for(t in a)n+=a[t].value;for(i in a)a[i].percent=a[i].value/n,a[i].sumPercent=a[i].percent+o,a[i].angle=360*a[i].percent,a[i].maxAngle=a[i].angle+s,a[i].minAngle=s,s=a[i].maxAngle,o=a[i].percent}function n(){for(var t=0;t<this.options.data.length;t++)this.context.beginPath(),this.context.arc(this.canvasWidth/2,this.canvasHeight/2,this.radius,this.options.data[t].minAngle/180*Math.PI-.5*Math.PI,this.options.data[t].maxAngle/180*Math.PI-.5*Math.PI),this.context.lineWidth=this.lineWidth,this.context.strokeStyle=this.options.data[t].color&&"string"==typeof this.options.data[t].color?this.options.data[t].color:"#ddd",this.context.stroke()}function s(t){this.context.beginPath(),this.context.arc(this.canvasWidth/2,this.canvasHeight/2,this.radius,this.options.data[t].minAngle/180*Math.PI-.5*Math.PI,this.options.data[t].maxAngle/180*Math.PI-.5*Math.PI),this.context.lineWidth=this.hoverLineWidth,this.context.strokeStyle=this.options.data[t].color&&"string"==typeof this.options.data[t].color?this.options.data[t].color:"#ddd",this.context.stroke()}function o(){var t=this,i=0,a=2/(t.options.animateTime/20),s=0,o=[];o[i]=setInterval(function(){t.context.beginPath(),t.context.arc(t.canvasWidth/2,t.canvasHeight/2,t.radius,t.options.data[i].minAngle/180*Math.PI-.5*Math.PI,(t.options.data[i].minAngle/180+s)*Math.PI-.5*Math.PI),t.context.lineWidth=t.lineWidth,t.context.strokeStyle=t.options.data[i].color&&"string"==typeof t.options.data[i].color?t.options.data[i].color:"#ddd",t.context.stroke(),s>=2*t.options.data[i].percent&&(s=0,clearInterval(o[i]),i++,i<t.options.data.length?o[i]=setInterval(arguments.callee,20):n.call(t)),s+=a},20)}function e(){var t=this,i=this.canvasWidth/4,a=this.canvasHeight/4,o=(this.radius+this.options.lineWidth)/2,e=(this.radius-this.options.lineWidth)/2,c=(this.radius+this.options.hoverLineWidth)/2,l=(this.radius-this.options.hoverLineWidth)/2,r=null;this.canvas.addEventListener("mousemove",function(d){var p=d.clientX-this.offsetLeft,v=d.clientY-this.offsetTop,f=p-i,g=v-a;if(Math.abs(f*f)+Math.abs(g*g)>=e*e&&Math.abs(f*f)+Math.abs(g*g)<=o*o){t.options.pointer&&(t.canvas.style.cursor="pointer");for(var u=0;u<t.options.data.length;u++)h(f,-g)>=t.options.data[u].minAngle&&h(f,-g)<t.options.data[u].maxAngle&&r!==u&&(r=u,t.context.clearRect(0,0,t.canvasWidth,t.canvasHeight),n.call(t),s.call(t,u),t.context.font=t.options.bold?"bold "+t.fontSize+"px "+t.options.fontFamily:t.fontSize+"px "+t.options.fontFamily,t.context.fillStyle=t.options.data[u].color,t.context.textAlign="center",t.context.textBaseline="middle",t.context.fillText((t.options.showName?t.options.data[u].name+" ":"")+(t.options.showValue?t.options.data[u].value+" ":"")+(t.options.showPercent?Math.round(1e3*t.options.data[u].percent)/10+"%":""),t.canvasWidth/2,t.canvasHeight/2))}else(Math.abs(f*f)+Math.abs(g*g)<l*l||Math.abs(f*f)+Math.abs(g*g)>c*c)&&(t.options.pointer&&(t.canvas.style.cursor=""),t.context.clearRect(0,0,t.canvasWidth,t.canvasHeight),n.call(t),r=null)})}function h(t,i){return t>0&&0>=i||0>=t&&0>=i?Math.atan(t/i)/Math.PI*180+180:0>t&&i>0?Math.atan(t/i)/Math.PI*180+360:t>=0&&i>0?Math.atan(t/i)/Math.PI*180:void 0}this.PercCircle=function(i,a){i=i&&"string"==typeof i?document.querySelector(i):i,this.el=i,this.canvasWidth=2*this.el.clientWidth,this.canvasHeight=2*this.el.clientHeight;var n={circleScale:.7,lineWidth:14,hoverEffect:!0,hoverLineWidth:null,pointer:!0,showName:!0,showValue:!1,showPercent:!0,fontFamily:"Microsoft Yahei",fontSize:14,bold:!0,animate:!0,animateTime:500,data:[]};if(a&&"object"==typeof a&&t(n,a),this.options=n,0===this.options.data.length)throw new Error("No data...");this.radius=this.canvasHeight<this.canvasWidth?this.canvasHeight/2:this.canvasWidth/2,this.radius=this.radius*this.options.circleScale,this.lineWidth=2*this.options.lineWidth,this.hoverLineWidth=this.options.LineWidth+4,this.fontSize=2*this.options.fontSize},PercCircle.prototype.init=function(){i.call(this),a.call(this),this.options.animate?o.call(this):n.call(this),this.options.hoverEffect&&e.call(this)}}();