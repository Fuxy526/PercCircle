!function(){function t(t,i){for(var n in i)t.hasOwnProperty(n)&&(t[n]=i[n])}function i(){var t=this.el.clientHeight,i=this.el.clientWidth;this.canvas=document.createElement("canvas"),this.canvas.style.height=t+"px",this.canvas.style.width=i+"px",this.canvas.height=this.canvasHeight,this.canvas.width=this.canvasWidth,this.el.appendChild(this.canvas),this.context=this.canvas.getContext("2d")}function n(){var t,i,n=this.options.data,a=0,o=0,e=0;for(t in n)a+=n[t].value;for(i in n)n[i].percent=n[i].value/a,n[i].sumPercent=n[i].percent+e,n[i].angle=360*n[i].percent,n[i].maxAngle=n[i].angle+o,n[i].minAngle=o,o=n[i].maxAngle,e=n[i].percent}function a(){for(var t=0;t<this.options.data.length;t++)this.context.beginPath(),this.context.arc(this.canvasWidth/2,this.canvasHeight/2,this.radius,this.options.data[t].minAngle/180*Math.PI-.5*Math.PI,this.options.data[t].maxAngle/180*Math.PI-.5*Math.PI),this.context.lineWidth=this.lineWidth,this.context.strokeStyle=this.options.data[t].color&&"string"==typeof this.options.data[t].color?this.options.data[t].color:"#ddd",this.context.stroke()}function o(t){this.context.beginPath(),this.context.arc(this.canvasWidth/2,this.canvasHeight/2,this.radius,this.options.data[t].minAngle/180*Math.PI-.5*Math.PI,this.options.data[t].maxAngle/180*Math.PI-.5*Math.PI),this.context.lineWidth=this.hoverLineWidth,this.context.strokeStyle=this.options.data[t].color&&"string"==typeof this.options.data[t].color?this.options.data[t].color:"#ddd",this.context.stroke()}function e(){var t=this,i=0,n=2/(t.options.animateTime/20),o=0,e=[];e[i]=setInterval(function(){t.context.beginPath(),t.context.arc(t.canvasWidth/2,t.canvasHeight/2,t.radius,t.options.data[i].minAngle/180*Math.PI-.5*Math.PI,(t.options.data[i].minAngle/180+o)*Math.PI-.5*Math.PI),t.context.lineWidth=t.lineWidth,t.context.strokeStyle=t.options.data[i].color&&"string"==typeof t.options.data[i].color?t.options.data[i].color:"#ddd",t.context.stroke(),o>=2*t.options.data[i].percent&&(o=0,clearInterval(e[i]),i++,i<t.options.data.length?e[i]=setInterval(arguments.callee,20):a.call(t)),o+=n},20)}function s(){var t=this,i=this.canvasWidth/4,n=this.canvasHeight/4,e=(this.radius+this.options.lineWidth)/2,s=(this.radius-this.options.lineWidth)/2,r=(this.radius+this.options.hoverLineWidth)/2,d=(this.radius-this.options.hoverLineWidth)/2,p=null;this.canvas.addEventListener("mousemove",function(v){var f=v.clientX-l(this),u=v.clientY-c(this),g=f-i,x=u-n;if(Math.abs(g*g)+Math.abs(x*x)>=s*s&&Math.abs(g*g)+Math.abs(x*x)<=e*e){t.options.pointer&&(t.canvas.style.cursor="pointer");for(var W=0;W<t.options.data.length;W++)h(g,-x)>=t.options.data[W].minAngle&&h(g,-x)<t.options.data[W].maxAngle&&p!==W&&(p=W,t.context.clearRect(0,0,t.canvasWidth,t.canvasHeight),a.call(t),o.call(t,W),t.context.font=t.options.bold?"bold "+t.fontSize+"px "+t.options.fontFamily:t.fontSize+"px "+t.options.fontFamily,t.context.fillStyle=t.options.data[W].color,t.context.textAlign="center",t.context.textBaseline="middle",t.context.fillText((t.options.showName?t.options.data[W].name+" ":"")+(t.options.showValue?t.options.data[W].value+" ":"")+(t.options.showPercent?Math.round(1e3*t.options.data[W].percent)/10+"%":""),t.canvasWidth/2,t.canvasHeight/2))}else(Math.abs(g*g)+Math.abs(x*x)<d*d||Math.abs(g*g)+Math.abs(x*x)>r*r)&&(t.options.pointer&&(t.canvas.style.cursor=""),t.context.clearRect(0,0,t.canvasWidth,t.canvasHeight),a.call(t),p=null)})}function h(t,i){return t>0&&0>=i||0>=t&&0>=i?Math.atan(t/i)/Math.PI*180+180:0>t&&i>0?Math.atan(t/i)/Math.PI*180+360:t>=0&&i>0?Math.atan(t/i)/Math.PI*180:void 0}function c(t){var i=t.offsetTop;return null!=t.offsetParent&&(i+=c(t.offsetParent)),i}function l(t){var i=t.offsetLeft;return null!=t.offsetParent&&(i+=l(t.offsetParent)),i}this.PercCircle=function(i,n){i=i&&"string"==typeof i?document.querySelector(i):i,this.el=i,this.canvasWidth=2*this.el.clientWidth,this.canvasHeight=2*this.el.clientHeight;var a={circleScale:.7,lineWidth:14,hoverEffect:!0,hoverLineWidth:null,pointer:!0,showName:!0,showValue:!1,showPercent:!0,fontFamily:"Microsoft Yahei",fontSize:14,bold:!0,animate:!0,animateTime:500,data:[]};if(n&&"object"==typeof n&&t(a,n),this.options=a,0===this.options.data.length)throw new Error("No data...");this.radius=this.canvasHeight<this.canvasWidth?this.canvasHeight/2:this.canvasWidth/2,this.radius=this.radius*this.options.circleScale,this.lineWidth=2*this.options.lineWidth,this.hoverLineWidth=this.options.hoverLineWidth?2*this.options.hoverLineWidth:this.lineWidth+8,this.fontSize=2*this.options.fontSize},PercCircle.prototype.init=function(){i.call(this),n.call(this),this.options.animate?e.call(this):a.call(this),this.options.hoverEffect&&s.call(this)}}();